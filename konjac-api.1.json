\";\nvar get_interval \u003d 1;\n\nfunction send_line(Me){\n  var payload \u003d {\u0027message\u0027 : Me};\n  var options \u003d{\n        \"method\"  : \"post\",\n        \"payload\" : payload,\n        \"headers\" : {\"Authorization\" : \"Bearer \"+ lineToken}  \n      };\n    UrlFetchApp.fetch(\"https://notify-api.line.me/api/notify\", options);\n}\n\n\nfunction fetchContactMail() {\n  //取得間隔\n  var now_time\u003d Math.floor(new Date().getTime() / 1000) ;//現在時刻を変換\n  var time_term \u003d now_time - (60 * get_interval); //変換\n\n  //検索条件指定\n  var strTerms \u003d \u0027(is:unread after:\u0027+ time_term + \u0027)\u0027;\n\n  //取得\n  var myThreads \u003d GmailApp.search(strTerms);\n  var myMsgs \u003d GmailApp.getMessagesForThreads(myThreads);\n  var valMsgs \u003d [];\n  for(var i \u003d 0; i \u003c myMsgs.length;i++){\n    valMsgs[i] \u003d myMsgs[i][0].getPlainBody().replace(/\\r?\\n/g, \u0027\u0027);\n  //  myMsgs[i].markRead(); //メッセージを既読にする\n  }\n\n  return valMsgs;\n\n}\n\nfunction main() {\n  //send_line(\"tetete!\")\n  new_Me \u003d fetchContactMail()\n  if(new_Me.length \u003e 0){\n    for(var i \u003d new_Me.length-1; i \u003e\u003d 0; i--){\n      send_line(new_Me[i])\n    }\n  }\n}\n\n"},{"name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Tokyo\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}